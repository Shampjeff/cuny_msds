---
title: "Regression Analysis for US Sentors Voting Patterns"
author: "Jeff shamp"
date: "`r Sys.Date()`"
output:
  prettydoc::html_pretty:
    theme: architect
    highlight: vingette
---

# Introduction

Is the net vote share won by Trump per district in 2016 predictive of a Senator's voting record with regards to the Trump agenda? Is the predicted agreement (with Trump) value generated by 538.com _more_ predictive of a Senator's actual voting record? 

538 updates a daily tally of who in congress supports President Trump by voting in alingment with his agenda. The also have built a prediction as to how frequently the Congressperson 'should' vote in alignment with President Trump based on various historical factors. 

I like this idea becuase it takes the general voting trend of a given district or state as a proxy for how aligned that location is with President Trump's agend. It makes for an interesting view into how well a member of Congress aligns with the voting record of their constituency vs. their alignment with Trump. 

For my analysis, I will be focusing on the Senate and how members vote regarding Trump's agenda.  

# Data Overview

A link to the data can be found [here](https://projects.fivethirtyeight.com/congress-trump-score/).

These data come from an observational study of the voting patterns of Senators serving in Congress during the Trump administration. Agreement with the Trump agend is defined by which bills the President openly supports. There is no experiment conducted here, it is simple a record of how each Senator has voted. Each case is the current (as of 5/5/2020) total votes for Senator, their home state, party affiliation, the percent they vote in agreement with the Trump administration, their predicted agreement by 538, and the net share of the vote won by Trump in their district in 2016. The variables of interest here are numeric; percent agreement, predicted agreement, net Trump vote share. Analysis of predictors by party are categorical; Democrat and Republican. Independents are excluded form this analysis for two reasons; 1) there are only two of them, and 2) one independent has been running for president as a democrat since 2016. 

```{r setup, echo=TRUE, results='hide', warning=FALSE, message=FALSE}
library(RCurl)
library(ggplot2)
library(dplyr)
```


```{r}
d<-getURL(
"https://raw.githubusercontent.com/Shampjeff/cuny_msds/master/DATA_607/data/averages.csv")
df<-read.csv(text=d, stringsAsFactors = FALSE)
senate_df<-subset(df, chamber=='senate' & congress==0)
senate_df<- subset(senate_df, select=-c(district,bioguide, chamber, congress))
senate_df$party[senate_df$party == "I"]<- "Independent"
senate_df$party[senate_df$party == "D"]<- "Democrat"
senate_df$party[senate_df$party == "R"]<-"Republican"
senate_df <- senate_df %>% filter(party != "Independent")
DT::datatable(senate_df,
              extensions = c('FixedColumns',"FixedHeader"),
              options = list(scrollX = TRUE, 
                         paging=TRUE,
                         fixedHeader=TRUE,
                         pageLength=7))
```


## Exploratory Data Analysis

As one might expect now the distribution is bimodal, there is a clear divide on agreement with Trump base on party affiliation. 

```{r, warning=FALSE}
senate_df %>%
  ggplot() +
  geom_histogram(aes(x=agree_pct, fill=party),
                 alpha=0.5,
                 binwidth = 0.03)+
  scale_fill_manual(values = c("blue", "red")) + 
  labs(x="Percent Agreement with Trump Agenda", 
       y="Count", 
       title="Histogram of Agreement Percent by Party")
```


## Predicted Agreement Score - Democrats

We will start with the predicted agreement score generated by 538 as a function of actual agreement via voting record. To do this, we will fit a linear model and assess it's fit. We will pay close attention to the conditions of inference; _linearity, constant variance, nearly normal residuals_. 


Let's start with a linear model and plot of agreement percent as a function of predicted score for each party separately. We will also show the model diagnostics below.

```{r}
senate_dem<- senate_df %>%
  filter(party == "Democrat")
dem_lin_reg<- lm(data=senate_dem, agree_pct ~ predicted_agree)

senate_df %>%
  filter(party =="Democrat") %>%
  select(predicted_agree, agree_pct) %>%
  ggplot(aes(x=predicted_agree, y=agree_pct)) +
  geom_abline(slope= dem_lin_reg$coefficients[2], 
              intercept = dem_lin_reg$coefficients[1]) +
  geom_point(color="blue") +
  labs(x="Predicted Agreement Score",
       y="Agreement Percent",
       title="Predicted Agreement Linear Fit")
```

```{r}
summary(dem_lin_reg)
```

Now we assess the residuals for linearity and normal distribution. 

```{r}
senate_dem %>%
  ggplot() +
  geom_point(aes(x=predicted_agree,
                 y=dem_lin_reg$residuals),
             color="blue") +
  geom_hline(yintercept = 0, 
             linetype="dashed") +
  labs(x="Predicted Agreement",
       y="Residuals",
       title="Residual Plot of Predicted Agreement")
```

We see there is an outlier at x=0.4, but these residual seem to be fairly well distributed around zero. There is also good indication of constant variance in the data as well. Let's also check the distribution. 

```{r}
ggplot(data = dem_lin_reg, aes(x=dem_lin_reg$residuals)) +
  geom_histogram(fill = "blue", color="black") +
  labs(x="Residuals", y="Count", 
       title="Residual Histogram")
```

Again, outside of one outlier, this appears to be nearly normal. 

## Summary of Predicted Agreement Score - Democrats

With the conditions for infernce met we see that the slope of the line for agreement percent as a function of predicted agreement by 538 is non-zero with p-value nearly zero (2.67e-10). The model can explain 56% of the variance in the data for democrats. 


## Predicted Agreement Score - Republicans

We will take a similar route with Republicans. 

```{r}
senate_rep<- senate_df %>%
  filter(party == "Republican")
rep_lin_reg<- lm(data=senate_rep, agree_pct ~ predicted_agree)

senate_df %>%
  filter(party =="Republican") %>%
  select(predicted_agree, agree_pct) %>%
  ggplot(aes(x=predicted_agree, y=agree_pct)) +
  geom_abline(slope= rep_lin_reg$coefficients[2], 
              intercept = rep_lin_reg$coefficients[1]) +
  geom_point(color="red") +
  labs(x="Predicted Agreement Score",
       y="Agreement Percent",
       title="Predicted Agreement Linear Fit")
```

```{r}
summary(rep_lin_reg)
```

Now we assess the residuals for linearity and normal distribution. 

```{r}
senate_rep %>%
  ggplot() +
  geom_point(aes(x=predicted_agree,
                 y=rep_lin_reg$residuals),
             color="red") +
  geom_hline(yintercept = 0, 
             linetype="dashed") +
  labs(x="Predicted Agreement",
       y="Residuals",
       title="Residual Plot of Predicted Agreement")
```

This do not appear to be too well distributed around zero with many points far below the y=0 line. There does appear to be constant variance.   

```{r}
ggplot(data = rep_lin_reg, aes(x=rep_lin_reg$residuals)) +
  geom_histogram(fill = "red", color="black") +
  labs(x="Residuals", y="Count", 
       title="Residual Histogram")
```

Again, several points below x=0 on the residual histogram indicate a left-skewed distribution. 

## Summary of Predicted Agreement Score - Republicans

With conditions reasonably met for a reliable model we see that predicted agreement as generated by 538 for Republicans fails to reject the null hypothesis for a non-zero slope with p-value= 0.122. The predicted agreement score is _not_ predictive for how a Republican will vote in alignment with the Trump Agenda. 


## Net Trump Vote - Democrats

We now turn out focus to if the net share of the vote won by Trump in 2016 is predictive of that senators voting record on the Trump agenda. 

```{r}
senate_dem<- senate_df %>%
  filter(party == "Democrat")
dem_lin_reg<- lm(data=senate_dem, agree_pct ~ net_trump_vote)

senate_df %>%
  filter(party =="Democrat") %>%
  select(net_trump_vote, agree_pct) %>%
  ggplot(aes(x=net_trump_vote, y=agree_pct)) +
  geom_abline(slope= dem_lin_reg$coefficients[2], 
              intercept = dem_lin_reg$coefficients[1]) +
  geom_point(color="blue") +
  labs(x="Net Trump Vote Share",
       y="Agreement Percent",
       title="Net Trump Vote Share Linear Fit")
```

```{r}
summary(dem_lin_reg)
```

Now we assess the residuals for linearity and normal distribution. 

```{r}
senate_dem %>%
  ggplot() +
  geom_point(aes(x=net_trump_vote,
                 y=dem_lin_reg$residuals),
             color="blue") +
  geom_hline(yintercept = 0, 
             linetype="dashed") +
  labs(x="Net Trump Vote Share",
       y="Residuals",
       title="Residual Plot of Net Trump Vote Share")
```

We see there is an outlier near 0% vote share, but these residual seem to be fairly well distributed around zero. There is also good indication of constant variance in the data as well. Let's also check the distribution. 

```{r}
ggplot(data = dem_lin_reg, aes(x=dem_lin_reg$residuals)) +
  geom_histogram(fill = "blue", color="black") +
  labs(x="Residuals", y="Count", 
       title="Residual Histogram")
```

These appear to be nearly normal with some reservations about the distribution of the residuals. Again, a few outliers skewing the data to the right. 

## Summary of Net Trump Vote Share - Democrats

Conditions for infernce are met and we see that the slope of the line for agreement percent as a function of net Trump vote share form 2016 is non-zero with p-value nearly zero (7.85e-11). The model can explain 59% of the variance in the data for democrats. This would make it a better predictor (by a small degree) than the predicted agreement generated by 538. 

## Net Trump Vote - Republicans

We now turn out focus to if the net share of the vote won by Trump in 2016 is predictive of that senators voting record on the Trump agenda. 

```{r}
senate_rep<- senate_df %>%
  filter(party == "Republican")
rep_lin_reg<- lm(data=senate_rep, agree_pct ~ net_trump_vote)

senate_df %>%
  filter(party =="Republican") %>%
  select(net_trump_vote, agree_pct) %>%
  ggplot(aes(x=net_trump_vote, y=agree_pct)) +
  geom_abline(slope= rep_lin_reg$coefficients[2], 
              intercept = rep_lin_reg$coefficients[1]) +
  geom_point(color="red") +
  labs(x="Net Trump Vote Share",
       y="Agreement Percent",
       title="Net Trump Vote Share Linear Fit")
```

```{r}
summary(rep_lin_reg)
```

Now we assess the residuals for linearity and normal distribution. 

```{r}
senate_rep %>%
  ggplot() +
  geom_point(aes(x=net_trump_vote,
                 y=rep_lin_reg$residuals),
             color="red") +
  geom_hline(yintercept = 0, 
             linetype="dashed") +
  labs(x="Net Trump Vote Share",
       y="Residuals",
       title="Residual Plot of Net Trump Vote Share")
```

We see a similar story with the previous analysis of Republicans a left-skewed distribution that is seems nearly normal.  

## Summary of Net Trump Vote Share - Republicans

Conditions for inference are met and we see that agreement percent as a function of net Trump vote share form 2016 fails to reject the null hypothesis for a non-zero slope with p-value=0.139. This is _not_ a predictor for how a Republican will vote in alignment with the Trump agenda. 



# Conclusion 

I was surprised by these results, but it seems to make sense to some extent. Net vote share and 538 predicted score are not predictors of how a Reoublican will vote alongside Trump. This suggests that for Senators in states that Trump lost or only marginally won, Republicans still will vote largely in alignment with Trump. This seems counter to the standard rules of political self-interest but clearly there must a some other factor that out-weighs voting margins or historical data. Democrats appear to have more freedom in how they vote, though they all seem to cap their agreement with the Trump agenda to under 60%. 
